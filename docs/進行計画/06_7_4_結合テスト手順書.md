# 6.7.4 結合テスト（手動）手順書

## 前提条件

- 開発サーバー起動: http://localhost:3001
- データベース起動済み
- GitHub OAuth認証設定済み

## テスト実施日時

- 実施日: 2025-10-15
- 実施者: Claude Code

---

## テストケース1: サインイン → TODO一覧表示

### 手順

1. ブラウザで http://localhost:3001 にアクセス
2. サインイン画面が表示されることを確認
3. 「GitHubでサインイン」ボタンをクリック
4. GitHubの認証画面で承認
5. `/todos` ページにリダイレクトされることを確認
6. TODO一覧が表示されることを確認

### 確認項目

- [x] サインイン画面が正しく表示される
- [x] GitHubでの認証が成功する
- [ ] `/todos` ページにリダイレクトされる
- [ ] TODO一覧データが表示される（データがある場合）
- [ ] ローディング状態が正しく表示される
- [ ] ユーザー名が表示される

### 結果

- 実施日時:
- 結果: ✅ / ❌
- 備考:

---

## テストケース2: TODO新規作成 → 一覧に反映

### 手順

1. TODO一覧画面で「新規TODO」ボタンをクリック
2. モーダルが開くことを確認
3. 以下の情報を入力:
   - タイトル: "結合テスト用TODO"
   - 説明: "6.7.4の結合テストで作成"
   - ステータス: "open"
   - 優先度: "high"
   - 期限: 2025-12-31
4. 「作成」ボタンをクリック
5. モーダルが閉じることを確認
6. 一覧に新しいTODOが追加されることを確認

### 確認項目

- [ ] 「新規TODO」ボタンが正しく動作する
- [ ] 作成モーダルが開く
- [ ] フォーム入力が正しく動作する
- [ ] バリデーションが動作する（必須項目など）
- [ ] 作成ボタンをクリックすると処理が実行される
- [ ] ローディング状態が表示される
- [ ] 成功後にモーダルが閉じる
- [ ] 一覧が自動的に再取得される
- [ ] 新しいTODOが一覧の先頭に表示される

### 結果

- 実施日時:
- 結果: ✅ / ❌
- 備考:

---

## テストケース3: TODO編集 → 一覧に反映

### 手順

1. 一覧から任意のTODOの「編集」ボタンをクリック
2. 編集モーダルが開き、現在の値が表示されることを確認
3. 以下を変更:
   - タイトルに「(編集済み)」を追加
   - 優先度を変更
4. 「更新」ボタンをクリック
5. モーダルが閉じることを確認
6. 一覧で変更内容が反映されることを確認

### 確認項目

- [ ] 編集ボタンが正しく動作する
- [ ] 編集モーダルが開く
- [ ] 現在の値が正しく表示される
- [ ] フォーム入力が正しく動作する
- [ ] 更新ボタンをクリックすると処理が実行される
- [ ] ローディング状態が表示される
- [ ] 成功後にモーダルが閉じる
- [ ] 一覧が自動的に再取得される
- [ ] 変更内容が一覧に反映される

### 結果

- 実施日時:
- 結果: ✅ / ❌
- 備考:

---

## テストケース4: TODO削除 → 一覧から削除

### 手順

1. 一覧から任意のTODOの「削除」ボタンをクリック
2. 確認ダイアログが表示されることを確認
3. ダイアログでTODOのタイトルが表示されることを確認
4. 「削除」ボタンをクリック
5. ダイアログが閉じることを確認
6. 一覧から該当TODOが削除されることを確認

### 確認項目

- [ ] 削除ボタンが正しく動作する
- [ ] 確認ダイアログが表示される
- [ ] ダイアログに正しいTODO情報が表示される
- [ ] 削除ボタンをクリックすると処理が実行される
- [ ] ローディング状態が表示される
- [ ] 成功後にダイアログが閉じる
- [ ] 一覧が自動的に再取得される
- [ ] 該当TODOが一覧から削除される

### 結果

- 実施日時:
- 結果: ✅ / ❌
- 備考:

---

## テストケース5: ステータス切替 → 即座に反映

### 手順

1. 一覧からステータスが "open" のTODOを選択
2. チェックボックスをクリック
3. 即座にチェック状態が変わることを確認（楽観的UI更新）
4. APIリクエストが送信されることを確認（開発者ツール）
5. 数秒後、ステータスが "done" に確定されることを確認

### 確認項目

- [ ] チェックボックスが正しく表示される
- [ ] クリックすると即座にUIが更新される（楽観的更新）
- [ ] APIリクエストが送信される
- [ ] 成功後もステータスが維持される
- [ ] エラー時はロールバックされる（ネットワークを切断してテスト）

### 結果

- 実施日時:
- 結果: ✅ / ❌
- 備考:

---

## テストケース6: フィルタ動作確認

### 6-1. 検索テキストフィルタ

#### 手順

1. 検索テキストボックスに文字列を入力
2. フィルタが適用され、一覧が更新されることを確認
3. 検索テキストをクリア
4. すべてのTODOが再表示されることを確認

#### 確認項目

- [ ] 検索テキストボックスが表示される
- [ ] 入力するとフィルタが適用される
- [ ] 該当するTODOのみが表示される
- [ ] クリアするとすべて表示される

### 6-2. ステータスフィルタ

#### 手順

1. ステータスドロップダウンで "open" を選択
2. ステータスが "open" のTODOのみ表示されることを確認
3. "done" を選択
4. ステータスが "done" のTODOのみ表示されることを確認
5. "すべて" を選択
6. すべてのTODOが表示されることを確認

#### 確認項目

- [ ] ステータスドロップダウンが表示される
- [ ] "open" を選択すると該当TODOのみ表示
- [ ] "done" を選択すると該当TODOのみ表示
- [ ] "すべて" を選択するとすべて表示

### 6-3. 優先度フィルタ

#### 手順

1. 優先度ドロップダウンで "high" を選択
2. 優先度が "high" のTODOのみ表示されることを確認
3. "mid" を選択
4. 優先度が "mid" のTODOのみ表示されることを確認
5. "すべて" を選択
6. すべてのTODOが表示されることを確認

#### 確認項目

- [ ] 優先度ドロップダウンが表示される
- [ ] "high" を選択すると該当TODOのみ表示
- [ ] "mid" を選択すると該当TODOのみ表示
- [ ] "low" を選択すると該当TODOのみ表示
- [ ] "すべて" を選択するとすべて表示

### 結果

- 実施日時:
- 結果: ✅ / ❌
- 備考:

---

## テストケース7: エラーケース確認

### 7-1. 未認証アクセス → サインイン画面へ

#### 手順

1. ブラウザのCookieをクリア（開発者ツール）
2. `/todos` に直接アクセス
3. `/signin` にリダイレクトされることを確認

#### 確認項目

- [ ] 未認証時は `/todos` にアクセスできない
- [ ] `/signin` に自動的にリダイレクトされる

### 7-2. 他人のTODO編集 → 403エラー

**注**: このテストはAPIレベルでは保護されていますが、UIレベルでは他人のTODOは表示されないため、スキップ可能です。

#### 確認項目

- [ ] スキップ（UIレベルで他人のTODOは表示されない）

### 7-3. 存在しないTODO → 404エラー

#### 手順（開発者ツールのコンソールで実施）

1. ブラウザの開発者ツールを開く
2. コンソールで以下を実行:
   ```javascript
   await fetch("/api/todos/non-existent-id");
   ```
3. 404レスポンスが返ることを確認

#### 確認項目

- [ ] 存在しないTODO IDでAPIを呼ぶと404エラーが返る
- [ ] エラーメッセージが適切に表示される

### 7-4. ネットワークエラー → エラーメッセージ

#### 手順

1. 開発者ツールのNetworkタブを開く
2. 「Offline」モードに設定
3. TODO作成やステータス切替を試みる
4. エラーメッセージが表示されることを確認
5. Offlineモードを解除

#### 確認項目

- [ ] ネットワークエラー時にエラーメッセージが表示される
- [ ] ユーザーに適切なフィードバックがある
- [ ] 処理が失敗してもアプリがクラッシュしない

### 結果

- 実施日時:
- 結果: ✅ / ❌
- 備考:

---

## テストケース8: サインアウト → サインイン画面へ

### 手順

1. TODO一覧画面で「サインアウト」ボタンをクリック
2. `/signin` ページにリダイレクトされることを確認
3. `/todos` に直接アクセスを試みる
4. `/signin` にリダイレクトされることを確認

### 確認項目

- [ ] サインアウトボタンが表示される
- [ ] クリックすると処理が実行される
- [ ] `/signin` にリダイレクトされる
- [ ] サインアウト後は `/todos` にアクセスできない

### 結果

- 実施日時:
- 結果: ✅ / ❌
- 備考:

---

## 総合評価

### 実施結果サマリー

- テストケース1: サインイン → TODO一覧表示 [ ]
- テストケース2: TODO新規作成 → 一覧に反映 [ ]
- テストケース3: TODO編集 → 一覧に反映 [ ]
- テストケース4: TODO削除 → 一覧から削除 [ ]
- テストケース5: ステータス切替 → 即座に反映 [ ]
- テストケース6: フィルタ動作確認 [ ]
- テストケース7: エラーケース確認 [ ]
- テストケース8: サインアウト → サインイン画面へ [ ]

### 全体所感

（テスト実施後に記入）

### 課題・バグ

（発見した問題を記入）

### 次のアクション

（必要な修正や改善項目を記入）

---

## 備考

- テスト実施時はブラウザの開発者ツールを開き、コンソールエラーやネットワークリクエストを確認すること
- エラーが発生した場合は、スクリーンショットを撮影し、エラーメッセージを記録すること
- 実施後はこのドキュメントを更新し、結果を記録すること
