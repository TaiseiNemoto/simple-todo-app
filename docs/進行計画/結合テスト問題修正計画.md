# 結合テスト問題修正計画

## 発見された問題

### 問題1: ルートパス (/) で404エラー

**現象**:

- http://localhost:3001/ にアクセスすると404エラーが表示される

**原因**:

- `src/app/page.tsx` が存在しない、または適切に実装されていない

**期待される動作**:

- 未認証の場合: `/signin` にリダイレクト
- 認証済みの場合: `/todos` にリダイレクト

**修正方針**:

- `src/app/page.tsx` を作成し、認証状態に応じたリダイレクト処理を実装

---

### ~~問題2: サインイン時にデータベース接続エラー~~ ✅ 解決済み

**現象**:

```
AccessDenied: PrismaClientInitializationError
Can't reach database server at `localhost:3306`
```

**原因**:

- MySQLデータベースサーバーが起動していなかった

**対応**:

- データベースを起動することで解決

---

## 修正タスク

### タスク1: ルートページの実装

**ファイル**: `src/app/page.tsx`

**実装内容**:

```typescript
import { redirect } from "next/navigation";
import { auth } from "@/auth";

export default async function RootPage() {
  const session = await auth();

  // 認証済みの場合はTODO一覧へ
  if (session?.user) {
    redirect("/todos");
  }

  // 未認証の場合はサインインページへ
  redirect("/signin");
}
```

**確認項目**:

- [ ] ファイル作成
- [ ] 認証済みユーザーが `/` にアクセス → `/todos` にリダイレクト
- [ ] 未認証ユーザーが `/` にアクセス → `/signin` にリダイレクト

---

## 修正後のテスト計画

### 修正完了後の確認項目

1. **ルートパスのリダイレクト**
   - [ ] 未認証で `/` → `/signin` にリダイレクト
   - [ ] 認証済みで `/` → `/todos` にリダイレクト

2. **サインイン機能**
   - [ ] GitHub認証が成功する
   - [ ] データベースにユーザーが保存される
   - [ ] `/todos` にリダイレクトされる

3. **TODO機能**
   - [ ] TODO一覧が表示される
   - [ ] TODO作成が成功する
   - [ ] TODO編集が成功する
   - [ ] TODO削除が成功する

---

## 実装順序

1. **即座に対応（必須）**
   - [x] データベースサーバーの起動確認・起動 ✅
   - [ ] `src/app/page.tsx` の実装

2. **その後**
   - [ ] 結合テストの再実施
   - [ ] 手順書への結果記録

---

## 次のアクション

1. タスク1を実施（`src/app/page.tsx` の作成）
2. 開発サーバー再起動
3. 結合テスト再実施
